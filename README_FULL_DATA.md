# Buff差价饰品监控系统 - 全量数据获取指南

## 系统功能

本系统基于Buff官方API，能够：
- 获取全部24,000+个CS:GO饰品数据
- 实时计算价差和利润率
- 提供现代化Web界面查看结果
- 支持直接跳转到Buff购买页面

## 启动方式

### 1. 样本数据模式（默认，推荐首次使用）
```bash
python run_api_system.py
# 或
python run_api_system.py --count 200
```
- 获取100-200个商品的样本数据
- 启动速度快（1-2分钟）
- 适合测试和演示

### 2. 指定页数模式（推荐）
```bash
python run_api_system.py --pages 10
```
- 获取前10页数据（约1000个商品）
- 平衡了数据量和速度
- 适合日常使用

```bash
python run_api_system.py --pages 50
```
- 获取前50页数据（约5000个商品）
- 较完整的数据集
- 需要10-20分钟

### 3. 全量数据模式（获取所有饰品）
```bash
python run_api_system.py --all
```
- 获取全部24,000+个饰品数据
- ⚠️ **需要30分钟到2小时**
- ⚠️ **需要稳定的网络连接**
- 适合深度分析和研究

## 数据获取详情

### API数据来源
- **Buff官方API**: `https://buff.163.com/api/market/goods`
- **数据准确性**: 高（官方接口）
- **更新频率**: 实时
- **总商品数**: 24,491个
- **总页数**: 1,225页（每页20个商品）

### 获取性能
- **并发数**: 5个并发请求
- **请求间隔**: 0.1秒
- **错误重试**: 自动重试3次
- **估计时间**: 
  - 10页: 2-5分钟
  - 100页: 20-30分钟
  - 全量: 1-2小时

### 数据内容
每个饰品包含：
- 商品ID和名称
- Buff当前价格
- 悠悠有品价格（模拟）
- 价差和利润率
- 商品图片
- 商品类别
- 购买链接

## 使用建议

### 首次使用
1. 先运行样本模式测试系统
```bash
python run_api_system.py --count 50
```

2. 确认系统正常后，使用中等数据量
```bash
python run_api_system.py --pages 20
```

3. 如需完整数据，再使用全量模式
```bash
python run_api_system.py --all
```

### 性能优化
- 确保网络连接稳定
- 运行期间避免其他高网络占用操作
- 可以在后台运行，使用 `nohup` 或 `screen`

### 数据存储
- 数据保存在 `data/` 目录
- 文件名包含时间戳
- JSON格式，易于分析和处理

## 监控和日志

系统会显示实时进度：
```
INFO:api_scrapers:发现 24491 个商品，共 1225 页
INFO:api_scrapers:第1页收集完成，获得 80 个商品
INFO:api_scrapers:第2页收集完成，获得 85 个商品
...
INFO:api_scrapers:API数据收集完成，共获得 19567 个商品
```

## 注意事项

1. **网络要求**: 需要能访问Buff.163.com
2. **时间成本**: 全量数据需要很长时间
3. **存储空间**: 全量数据约10-20MB
4. **API限制**: 系统已内置速率控制
5. **数据时效**: 价格数据实时更新

## 故障排除

### 常见问题
1. **网络超时**: 检查网络连接，系统会自动重试
2. **部分页面失败**: 正常现象，系统会跳过错误页面
3. **内存不足**: 减少页数或重启系统

### 查看日志
```bash
# 实时查看日志
tail -f logs/monitor.log
```

## Web界面使用

系统启动后会显示访问地址，通常是：
- http://localhost:8000

界面功能：
- 📊 查看价差统计
- 🔍 搜索和筛选商品
- 🔗 直接跳转购买链接
- 📈 价差趋势分析 